# 随机微分方程组参数估计

这个项目提供了一个针对包含潜变量的随机微分方程组进行参数估计的实现方法。特别是，它处理以下随机微分方程组：

```
δS_t = r S_t δt + β L_t S_t δW_t^γ + σ_S S_t δW_t^S
δL_t = α(θ̄ - L_t)δt + σ_L δW_t^L
```

其中：
- S_t: 股票价格（可观测变量）
- L_t: 市场流动性（潜变量/不可观测）
- r, α, β, θ̄, σ_S, σ_L: 模型参数
- ρ1, ρ2, ρ3: 布朗运动之间的相关系数
- W_t^γ, W_t^S, W_t^L: 相关的维纳过程（布朗运动）

## 方法概述

由于该系统包含潜变量L_t，传统的最小二乘法无法直接应用。我们采用了结合扩展卡尔曼滤波(EKF)和最大似然估计(MLE)的方法：

1. **扩展卡尔曼滤波**：用于估计潜变量L_t的状态
2. **最大似然估计**：基于观测到的S_t和估计的L_t计算似然，并最大化似然以估计参数

## 算法流程

1. 初始化参数猜测值
2. 使用扩展卡尔曼滤波基于当前参数估计潜变量L_t的状态序列
3. 计算对数似然
4. 使用优化算法（如L-BFGS-B）最大化对数似然（或最小化负对数似然）
5. 迭代步骤2-4直到收敛
6. 返回最优参数估计和估计的潜变量序列

## 实现细节

### 扩展卡尔曼滤波

EKF用于估计潜变量L_t的状态，主要包括两个步骤：
- **预测步骤**：基于上一个状态和模型动态预测当前状态
- **更新步骤**：使用观测数据更新预测的状态

### 最大似然估计

我们使用最大似然方法估计参数。负对数似然函数被最小化以找到最优参数。最大似然估计在统计上是一致的，意味着随着样本量的增加，估计会收敛到真实参数。

### 欧拉-马鲁亚马离散化

为了模拟连续时间SDE，我们使用欧拉-马鲁亚马方法进行离散化，这是一种一阶随机数值方法。

## 使用方法

### 依赖

- Python 3.x
- NumPy
- SciPy
- Matplotlib

### 基本用法

```python
from sde_parameter_estimation import SDEParameterEstimator

# 导入您的股票价格数据
stock_prices = ...  # 一个包含股票价格时间序列的numpy数组
dt = 1/252  # 时间步长（例如，对于日度数据使用1/252）

# 创建估计器
estimator = SDEParameterEstimator(stock_prices, dt)

# 设置初始参数猜测
initial_params = (
    0.03,    # r: 无风险利率
    0.7,     # alpha: 均值回归速度
    0.2,     # beta: 流动性影响系数
    0.8,     # theta_bar: 长期平均流动性
    0.15,    # sigma_S: 股票价格波动率
    0.08,    # sigma_L: 流动性波动率
    0.2,     # rho1: 相关系数1
    0.1,     # rho2: 相关系数2
    0.0      # rho3: 相关系数3
)

# 估计参数
estimated_params, L_estimated = estimator.estimate_parameters(initial_params)

# 打印结果
print("估计参数:", estimated_params)

# 可视化结果
estimator.plot_results(stock_prices, L_estimated, estimated_params)
```

## 示例

该项目包含一个示例，演示如何使用模拟数据评估方法的性能。运行`sde_parameter_estimation.py`文件可以查看示例：

```
python sde_parameter_estimation.py
```

## 注意事项

1. 参数估计的质量取决于初始猜测的质量。如果初始猜测远离真实值，优化可能会陷入局部最小值。
2. 确保股票价格数据有足够的变化以捕获模型动态。使用太短的数据序列可能导致参数识别问题。
3. 该方法计算密集，对于长时间序列可能需要较长的运行时间。

## 扩展可能性

1. 实现粒子滤波器作为EKF的替代方法，以处理更复杂的非线性和非高斯随机过程
2. 添加马尔可夫链蒙特卡洛(MCMC)方法进行贝叶斯参数估计
3. 扩展模型以包含更多潜变量或更复杂的动态